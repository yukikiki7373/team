<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- http://getbootstrap.com/docs/4.5/ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="../static/dreams.css">

  <!-- min jQuery CDN -->
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>

  <link href="../static/favicon.ico" rel="icon">
    <title>もしもボックス</title>
</head>
 
 <body>
<!----------------------------------------------メニュー----------------------------------->
<nav class="navbar navbar-expand-md navbar-light" style="background-color: #748eff;">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav4" aria-controls="navbarNav4" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

            <div class="collapse navbar-collapse" id="navbarNav4">
               
                    <ul class="navbar-nav mr-auto mt-2">
                        <li class="nav-item nav-space-left"><a class="nav-link" href="dreams"><span class="menu-color">もしもボックス</span></a></li>
    
                        <li class="nav-item nav-space-left"><a class="nav-link" href="secrets"><span class="menu-color">ひみつ道具</span></a></li>

                        <li class="nav-item nav-space-left"><a class="nav-link" href="mypage_c"><span class="menu-color">マイページ</span></a></li>
                    </ul>

                    <ul class="navbar-nav ml-auto mt-2 nav-space-right">
                        <li class="nav-item"><a class="nav-link green" href="/logout"><span class="menu-color">ろぐあうと</span></a></li>
                    </ul>
  
            </div>
  </nav>
<!----------------------------------------------//メニュー----------------------------------->

<!------------------------------タイトルと画像------------------------------------------------>
  <main>
        <div class="title-wrapper">
             <img src="../static/img/shine.png" alt="">
             <h1 class="title-color">ひみつ道具</h1>
             <img src="../static/img/shine.png" alt="">
        </div>

<!------------------------------//タイトルと画像------------------------------------------------>

<!--------------------------------検索欄----------------------------------------->

        <div class="form-wrapper">
          <form action="/buy" method="post">
            <div class="form-group">
                <input autocomplete="off" autofocus class="form-control" name="symbol" placeholder="検索" type="text">
            </div>
          </form>
      </div>
 <!--------------------------------//検索欄-----------------------------------------> 
  

  
  
 <!-------------------------ひみつ道具投稿---------------------------> 
      <form class="form-secrets-width" name="f" method="post">
        <div class="secrets-color">
          <table class="table table-striped">
            <tbody>
  
              <tr class="form-control-secrets">
                <td>
                  <input type="textarea" class="form-control-width" id="title_area"  placeholder="タイトル">
                </td>
              </tr>
              <!----画像読み取って表示-->
              <tr class="img-border">
                 <td>
                  <label>画像：<input type="file" accept="image/jpeg,image/png,image/gif" onchange="fileup(this)" /></label>
                  <img src="" id="img" />
                 </td>
              </tr>
  
              <tr class="form-control-secrets">
                <td>
                  <textarea class="form-control-width" cols="40" rows="8" id="comment_area"  placeholder="「ひみつ道具」説明" ></textarea>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
         <!--投稿ボタン-------->
          <button class="btn btn-light btn-secrets-width" type="submit">「ひみつ道具」を投稿</button>
  
      </form>
<!-------------------------//ひみつ道具投稿---------------------------> 
  </main>


  <script>
    /*-----タイトルと説明がエンターを押すと繋がる---*/
    (function(){
      $('#title_area').on("keydown", function(e) {
        if( e.keyCode == 13 || e.keyCode == 40) {
          $("#comment_area").select();
          return false;
        }
      });
      $('#comment_area').on("keydown", function(e) {
        if( e.keyCode == 38 && this.selectionStart == 0) {
          $("#title_area").select();
          return false;
        }
      });
    })();

/*---画像を取得してリサイズする--*/
    const fileup = (e) => {
  const img = document.getElementById('img');
  const reader = new FileReader();
  const imgReader = new Image();
  const imgWidth = 680;
  reader.onloadend = () => {
    imgReader.onload = () => {
      const imgType = imgReader.src.substring(5, imgReader.src.indexOf(';'));
      const imgHeight = imgReader.height * (imgWidth / imgReader.width);
      const canvas = document.createElement('canvas');
      canvas.width = imgWidth;
      canvas.height = imgHeight;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(imgReader,0,0,imgWidth,imgHeight);
      img.src = canvas.toDataURL(imgType);
    }
    imgReader.src = reader.result;
  }
  reader.readAsDataURL(e.files[0]);
}


  </script>
</body>
</html>

